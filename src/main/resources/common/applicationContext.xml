<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"
  default-autowire="byName">

  <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager" scope="prototype"/>

  <bean id="gameDao" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.model.dao.HibernateGameDao"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="store*">PROPAGATION_REQUIRED</prop>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="personDao" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
    	<bean class="uk.co.unclealex.rokta.model.dao.HibernatePersonDao"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="store*">PROPAGATION_REQUIRED</prop>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="roundDao" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.model.dao.HibernateRoundDao"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="store*">PROPAGATION_REQUIRED</prop>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="playDao" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.model.dao.HibernatePlayDao"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="store*">PROPAGATION_REQUIRED</prop>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="colourDao" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.model.dao.HibernateColourDao"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="remove*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="dateUtil" class="uk.co.unclealex.rokta.util.DateUtilImpl"/>
  <bean id="personManager" class="uk.co.unclealex.rokta.process.PersonManagerImpl" scope="prototype"/>
  <bean id="gameManager"
    class="uk.co.unclealex.rokta.process.PersistingGameManager"
    scope="prototype" autowire-candidate="false"/>

  <bean id="gamesLostDatasetProducer" class="uk.co.unclealex.rokta.process.dataset.GamesLostDatasetProducer"
    scope="prototype"/>

  <bean id="handChoiceDatasetProducer" class="uk.co.unclealex.rokta.process.dataset.HandCountingDatasetProducer"
    autowire="no" scope="prototype"/>

  <bean id="openingGambitDatasetProducer" class="uk.co.unclealex.rokta.process.dataset.HandCountingDatasetProducer"
    autowire="no" scope="prototype"/>

  <bean id="leagueGraphDatasetProducer" class="uk.co.unclealex.rokta.process.dataset.LeagueGraphDatasetProducerImpl"
    scope="prototype">
    <property name="averageColour">
      <value>Orange</value>
    </property>
  </bean>

  <bean id="leagueManager"
    class="uk.co.unclealex.rokta.process.LeagueManagerImpl" scope="prototype">
  </bean>

  <bean id="statisticsManager"
    class="uk.co.unclealex.rokta.process.StatisticsManagerImpl" scope="prototype">
  </bean>

  <bean id="profileManager" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.process.ProfileManagerImpl"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean>

  <bean id="importExportManager" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" scope="prototype">
    <property name="target">
      <bean class="uk.co.unclealex.rokta.process.HibernateImportExportManager"/>
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="export*">PROPAGATION_REQUIRED,readOnly</prop>
        <prop key="import*">PROPAGATION_REQUIRED</prop>
      </props>
    </property>
  </bean>

  <bean id="sessionFactory"
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="configLocation">
      <value>classpath:hibernate.cfg.xml</value>
    </property>
    <property name="configurationClass">
      <value>org.hibernate.cfg.AnnotationConfiguration</value>
    </property>
  </bean>
</beans>

